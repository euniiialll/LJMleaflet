<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>New Nomal 공연 리플렛</title>
<style>
  :root { --w:390px; }
  html,body{margin:0;background:#000;font-family:sans-serif;color:#fff}
  .wrap{width:var(--w);margin:0 auto;position:relative;background:#111}
  .bg{position:absolute;inset:0;background:url("Leaflet.jpg") top left/100% auto no-repeat;pointer-events:none}
  .vb{
    position:absolute; width:120px; border-radius:12px; overflow:hidden;
    box-shadow:0 6px 16px rgba(0,0,0,.45);
    outline:1px dashed rgba(255,255,255,.15); cursor:move;
  }
  .vb video{width:100%;height:auto;display:block}
  .hint{
    position:fixed;left:8px;bottom:8px;right:8px;color:#bbb;font-size:12px;line-height:1.6;opacity:.85
  }
  .grid::before{content:"";position:absolute;inset:0;pointer-events:none;mix-blend-mode:screen;opacity:.22;
    background:repeating-linear-gradient(to right, rgba(255,255,255,.05) 0 1px, transparent 1px 10px),
               repeating-linear-gradient(to bottom, rgba(255,255,255,.06) 0 1px, transparent 1px 10px);}
  .locked .vb{cursor:default; outline:none}
</style>
</head>
<body>
<div id="wrap" class="wrap">
  <div class="bg"></div>

  <!-- ▼ 초기 배치(임시). 필요시 E키→드래그/휠로 조정 후 P키로 좌표 고정값 복사하세요 -->
  <div class="vb" data-src="1-2.mp4"         style="top:300px;   left:24px;  width:128px;"></div>
  <div class="vb" data-src="2-2.mp4"         style="top:640px;   left:238px; width:120px;"></div>
  <div class="vb" data-src="3-2.mp4"         style="top:980px;   left:28px;  width:134px;"></div>
  <div class="vb" data-src="4-3.mp4"         style="top:1320px;  left:232px; width:120px;"></div>
  <div class="vb" data-src="5-2.mp4"         style="top:1660px;  left:30px;  width:132px;"></div>
  <div class="vb" data-src="6-2.mp4"         style="top:2000px;  left:234px; width:122px;"></div>
  <div class="vb" data-src="7-2.mp4"         style="top:2340px;  left:32px;  width:132px;"></div>
  <div class="vb" data-src="김연아.mp4"       style="top:2680px;  left:236px; width:122px;"></div>
  <div class="vb" data-src="나경호.mp4"       style="top:3020px;  left:28px;  width:134px;"></div>
  <div class="vb" data-src="나정운.mp4"       style="top:3360px;  left:234px; width:122px;"></div>
  <div class="vb" data-src="이마드리드.mp4"   style="top:3700px;  left:30px;  width:132px;"></div>
  <div class="vb" data-src="이정민.mp4"       style="top:4040px;  left:236px; width:122px;"></div>
  <div class="vb" data-src="이지윤.mp4"       style="top:4380px;  left:28px;  width:134px;"></div>
  <div class="vb" data-src="이창민.mp4"       style="top:4720px;  left:234px; width:122px;"></div>
  <div class="vb" data-src="홍성현.mp4"       style="top:5060px;  left:30px;  width:132px;"></div>
</div>

<div class="hint">
  ▶ **E**: 편집/고정 토글 · **G**: 그리드 토글 · **P**: 현재 좌표 HTML 복사(콘솔) · 드래그=이동 · 휠=크기(Shift=미세)<br/>
  - 배경은 <b>Leaflet.jpg</b> (대소문자 주의). 폭 390px 기준으로 원본 비율에 맞게 컨테이너 높이가 자동 설정됩니다.
</div>

<script>
  // 1) 배경 높이를 원본 이미지 비율에 맞춰 자동 설정
  (function(){
    const wrap = document.getElementById('wrap');
    const img = new Image();
    img.onload = () => {
      const w = parseInt(getComputedStyle(wrap).width);
      wrap.style.height = (img.naturalHeight * (w / img.naturalWidth)) + 'px';
      wrap.classList.add('grid'); // 시작 시 그리드 표시
    };
    img.src = 'Leaflet.jpg';
  })();

  // 2) 비디오 삽입
  document.querySelectorAll('.vb').forEach(b=>{
    const v = document.createElement('video');
    v.autoplay = true; v.loop = true; v.muted = true; v.playsInline = true; v.controls = true;
    const s = document.createElement('source'); s.src = b.dataset.src; s.type = 'video/mp4';
    v.appendChild(s); b.appendChild(v);
  });

  // 3) 편집(드래그/리사이즈) 기능
  const wrap = document.getElementById('wrap');
  let editing = true; // 시작은 편집 On
  let dragging=null, startX=0, startY=0, baseL=0, baseT=0;

  function clamp(n,min,max){return Math.max(min,Math.min(max,n));}

  function setLocked(lock){
    editing = !lock;
    document.body.classList.toggle('locked', lock);
    document.querySelectorAll('.vb').forEach(v=>{
      v.style.outline = lock ? 'none' : '1px dashed rgba(255,255,255,.15)';
      v.style.cursor  = lock ? 'default' : 'move';
    });
  }

  document.addEventListener('mousedown',e=>{
    if(!editing) return;
    const t = e.target.closest('.vb'); if(!t) return;
    dragging=t; const r=t.getBoundingClientRect(), wr=wrap.getBoundingClientRect();
    startX=e.clientX; startY=e.clientY; baseL=r.left-wr.left; baseT=r.top-wr.top; e.preventDefault();
  });
  document.addEventListener('mousemove',e=>{
    if(!dragging||!editing) return;
    const wr=wrap.getBoundingClientRect();
    let nx=baseL+(e.clientX-startX), ny=baseT+(e.clientY-startY);
    nx=clamp(nx,0,wr.width-dragging.offsetWidth);
    ny=clamp(ny,0,wr.height-dragging.offsetHeight);
    dragging.style.left=nx+'px'; dragging.style.top=ny+'px';
  });
  document.addEventListener('mouseup',()=>dragging=null);

  // 휠로 너비 조절 (Shift=미세)
  document.addEventListener('wheel',e=>{
    if(!editing) return;
    const t=e.target.closest('.vb'); if(!t) return;
    e.preventDefault();
    const step=e.shiftKey?2:10;
    const newW=Math.max(60,(parseInt(t.style.width||'120') + (e.deltaY>0?-step:step)));
    const wr=wrap.getBoundingClientRect();
    const left=parseInt(t.style.left||'0'); const maxLeft=Math.max(0, wr.width-newW);
    t.style.left=clamp(left,0,maxLeft)+'px';
    t.style.width=newW+'px';
  }, {passive:false});

  // 단축키: E(편집 토글) / G(그리드) / P(좌표 출력)
  document.addEventListener('keydown',e=>{
    const k=e.key.toLowerCase();
    if(k==='e'){ setLocked(editing); }
    if(k==='g'){ wrap.classList.toggle('grid'); }
    if(k==='p'){
      const css=[...document.querySelectorAll('.vb')].map(el=>{
        const top=el.style.top||'0px', left=el.style.left||'0px', w=el.style.width||'120px', src=el.dataset.src;
        return `<div class="vb" data-src="${src}" style="top:${top}; left:${left}; width:${w};"></div>`;
      }).join('\n');
      console.clear();
      console.log('▼ 아래 블록을 .wrap 내부에 붙여넣으면 고정 배치가 됩니다 ▼\n'+css);
      alert('콘솔(F12) → Console 탭에 현재 좌표 블록이 출력되었습니다. 복사해 붙여넣어 고정하세요!');
    }
  });

  // 초기 상태: 편집 ON
  setLocked(false);
</script>
</body>
</html>
